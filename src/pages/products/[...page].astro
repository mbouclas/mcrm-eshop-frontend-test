---
import {PropertiesService} from "@services/properties.service";
import {ProductsService} from "@services/products.service";
import {arrayPaginator} from "@helpers/paginate-array";
import Layout from "@layouts/Layout.astro";
export async function getStaticPaths() {
    const propertiesService = new PropertiesService();
    const allProducts = await (new ProductsService).load();
    const all = [];

    const firstPage = arrayPaginator(allProducts, 1);
    for (let idx = 0; idx < firstPage.totalPages; idx++) {
        all.push({
            params: {
                page: idx === 0 ? undefined : (idx + 1).toString(),
            },
            props: {
                paginated: arrayPaginator(allProducts, idx + 1),
                latest: allProducts.slice(0, 4)
            }
        })
    }

    return all;
}

const {page = 1} = Astro.params;
const { paginated, latest } = Astro.props;


---
<Layout title="Products">
{page}/{paginated.totalPages}/{paginated.total}
</Layout>
